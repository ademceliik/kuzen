<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bir Web Sitesi</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    #login, #messages { display: none; }
    .message { border-bottom: 1px solid #ccc; padding: 5px; }
  </style>
</head>
<body>

  <div id="login">
    <h2>PIN Kodunuzu Girin</h2>
    <input type="password" id="pinInput" placeholder="PIN Kodu">
    <button id="pinBtn">Giriş</button>
    <div id="pinError" style="color: red;"></div>
  </div>

  <div id="messages">
    <h2>Mesajlar</h2>
    <form id="messageForm">
      <textarea id="messageText" placeholder="Mesajınız" required></textarea><br>
      <button type="submit">Gönder</button>
    </form>
    <div id="messageList"></div>
  </div>

  <script>
    // ES5 uyumlu pin listesi
    var pinList = {
      "5055": "Apo",
      "6365": "Adem",
      "6470": "A.Kadir",
      "4378": "Ahmet"
    };

    var loginDiv = document.getElementById("login");
    var messagesDiv = document.getElementById("messages");
    var pinInput = document.getElementById("pinInput");
    var pinBtn = document.getElementById("pinBtn");
    var pinError = document.getElementById("pinError");
    var messageForm = document.getElementById("messageForm");
    var messageText = document.getElementById("messageText");
    var messageList = document.getElementById("messageList");

    var currentUser = null;

    // PIN kontrolü
    pinBtn.onclick = function() {
      var pin = pinInput.value;
      if (pinList.hasOwnProperty(pin)) {
        currentUser = pinList[pin];
        showMessages();
      } else {
        pinError.textContent = "Geçersiz PIN";
      }
    };

    // Sayfa yüklendiğinde login ekranını göster
    loginDiv.style.display = "block";

    // Mesajları yükle ve göster
    function showMessages() {
      loginDiv.style.display = "none";
      messagesDiv.style.display = "block";
      loadMessages();
    }

    function loadMessages() {
      var msgs = JSON.parse(localStorage.getItem("messages") || "[]");
      messageList.innerHTML = "";
      for (var i = msgs.length - 1; i >= 0; i--) {
        var msg = msgs[i];
        var div = document.createElement("div");
        div.className = "message";
        div.innerHTML = "<strong>" + msg.name + "</strong> [" + msg.date + "]<br>" + msg.text;
        messageList.appendChild(div);
      }
    }

    // Mesaj gönderme
    messageForm.onsubmit = function(e) {
      e.preventDefault();
      var text = messageText.value;
      var msgs = JSON.parse(localStorage.getItem("messages") || "[]");
      msgs.push({
        name: currentUser,
        date: new Date().toLocaleString(),
        text: text
      });
      localStorage.setItem("messages", JSON.stringify(msgs));
      messageText.value = "";
      loadMessages();
    };
  </script>

</body>
</html>
